import fs from "fs"
import { defineConfig } from "rollup"


const packageJsonContent = fs.readFileSync("./package.json").toString()

const version = process.env.SEMANTIC_RELEASE_NEXT_VERSION || JSON.parse(packageJsonContent).version

console.info("Building version:", version)

const banner = `/**
 * HtmlMark v${version} - a markdown parser
 * Copyright (c) 2020-${new Date().getFullYear()}, Kiran Parajuli. (GNU Licensed)
 * https://github.com/kiranparajuli589/htmlmark
 */

/**
 * DO NOT EDIT THIS FILE
 * The code in this file is generated from files in ./lib/index.js
 */
`

export default defineConfig([{
	input: "lib/index.js", output: [{
		file: "dist/htmlmark.esm.js", format: "esm", sourcemap: true, banner
	}, {
		file: "dist/htmlmark.min.js", format: "umd", name: "htmlmark", sourcemap: false, banner
	}, {
		file: "dist/htmlmark.cjs", format: "cjs", sourcemap: true, name: "htmlmark", banner
	}, {
		file: "dist/htmlmark.umd.js", format: "umd", name: "htmlmark", sourcemap: true, banner
	}]
}])
